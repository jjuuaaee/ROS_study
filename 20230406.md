# 4ì›” 6ì¼ ëª©ìš”ì¼

# ğŸ“Œ ë‹¨ì¼ ë…¸ë“œì—ì„œ ë‹¤ì¤‘ talker & listener

## âœ…  talker.py

```python
#!/usr/bin/env python

import rospy
from std_msgs.msg import String
import threading

class Chatter:
    def __init__(self):
        rospy.init_node('chatter_node', anonymous=True)
        self.pub1 = rospy.Publisher('talk1', String, queue_size=10)
        self.pub2 = rospy.Publisher('talk2', String, queue_size=10)
        self.rate = rospy.Rate(0.5)

    def talker1(self):
        a = 1
        while not rospy.is_shutdown():
            hello_str = 'talk1 %s' % a
            a += 1
            rospy.loginfo(hello_str)
            self.pub1.publish(hello_str)
            self.rate.sleep()

    def talker2(self):
        a = 1
        while not rospy.is_shutdown():
            hello_str2 = 'talk2 %s' % a
            a += 1
            rospy.loginfo(hello_str2)
            self.pub2.publish(hello_str2)
            self.rate.sleep()

if __name__ == '__main__':
    try:
        chat = Chatter()
        t1 = threading.Thread(target=chat.talker1)
        t2 = threading.Thread(target=chat.talker2)

        t1.start()
        t2.start()

        t1.join()
        t2.join()
    except rospy.ROSInterruptException:
        pass
```

- import rospy (rcply íŒ¨í‚¤ì§€ë„ ì„¤ì¹˜ ì™„ë£Œ, ì„¤ì • ì˜ˆì •)
- rcply íŒ¨í‚¤ì§€ë„ ì‹¤í–‰ ì‹œ, node ë³€ìˆ˜ ì‚¬ìš© ê°€ëŠ¥
- ë‘ ê°œ ì´ìƒì˜ ë‹¤ì¤‘ talkerëŠ” threading í•¨ìˆ˜ë¡œ ì‹¤í–‰
- class ëª…ì„ ëŒ€ë¬¸ì ì‚¬ìš©í•˜ì—¬ Chatter ë¡œ ì§€ì • (ì¶”í›„ class 1ë²ˆ ì‹¤í–‰)
- **init** í•¨ìˆ˜ì™€ talker1, talker2 í•¨ìˆ˜ë¥¼ ê°ê° ì§€ì •

```python
rospy.init_node('chatter_node', anonymous=True)

self.pub1 = rospy.Publisher('talk1', String, queue_size=10)
self.pub2 = rospy.Publisher('talk2', String, queue_size=10)

self.rate = rospy.Rate(0.5)
```

- ë…¸ë“œë¥¼ ì´ˆê¸°í™”, ì´ˆê¸° ì„¤ì •, ë§ˆìŠ¤í„°ì™€ í†µì‹ 
- ë…¸ë“œ ë‹¹ í•œ ë²ˆë§Œ ì‘ì„±í•˜ë¯€ë¡œ init ë…¸ë“œì— í¬í•¨
- ë…¸ë“œ ì´ë¦„ : chatter_node / ì´ë¦„ ì¤‘ë³µ : ë¹„í—ˆìš©
- rospy.Publisher ë‘ ë²ˆ ì‘ì„±í•´ì„œ ë‘ ê°œì˜ talk ë°›ê¸°
- 1ì´ˆì— 0.5 = 2ì´ˆì— 1

## âœ…  listener.py

```python
#!/usr/bin/env python

import rospy
from std_msgs.msg import String

class Listener:
    def __init__(self):
        rospy.init_node('listener', anonymous=True)
        rospy.Subscriber("talk1", String, self.callback_talker1)
        rospy.Subscriber("talk2", String, self.callback_talker2)

    def callback_talker1(self, data):
        rospy.loginfo("Received from talker1: %s", data.data)

    def callback_talker2(self, data):
        rospy.loginfo("Received from talker2: %s", data.data)

    def start_listening(self):
        rospy.spin()

if __name__ == '__main__':
    try:
        listener = Listener()
        listener.start_listening()
    except rospy.ROSInterruptException:
        pass
```

**`rospy.spin()`**

- ë©”ì‹œì§€ ì²˜ë¦¬ë¥¼ ê³„ì†í•  ìˆ˜ ìˆë„ë¡ ë…¸ë“œê°€ ê³„ì† ì‹¤í–‰
- ë…¸ë“œ ì¢…ë£Œ, ì˜ˆì™¸ ë°œìƒ, Ctrl+C ë“±ìœ¼ë¡œ ì¢…ë£Œë˜ê¸° ì „ê¹Œì§€ ë¸”ë¡œí‚¹

## âœ…  ìœ ì˜ì‚¬í•­

- íŒŒì¼ ëª…ì„ [talker.py /](http://talker.py) [listener.py](http://listener.py) ë¡œ ì§€ì •í•œ ë’¤, íŒŒì¼ ìœ„ì¹˜ì—ì„œ rosrunìœ¼ë¡œ ì‹¤í–‰